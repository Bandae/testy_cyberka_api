import{R as C}from"./ReviewComponent.4293669d.js";import{_ as A,r as i,u as M,s as B,k as P,f as T,o as n,c as l,a as o,e as c,b as D,w as u,v as _,F as V,d as h,t as k,A as I,p as F,l as N,i as j,j as E}from"./index.8a97678d.js";const L={name:"UserProfileView",components:{ReviewComponent:C},async setup(){const a=i(!1),r=i(!1),p=M(),{loggedIn:e,userId:v,is_staff:m}=B(p),d=i([]),t=i(""),f=i(""),w=i(""),y=i(""),g=i(""),b=i(""),R=P().params.id;async function S(){return(await I().get(`user/${R}`)).data}async function q(){for(;d.value.length;)d.value.pop();try{await I(!0).post("movies/",{title_pl:t.value,title_eng:f.value,year:w.value,runtime:y.value,director:g.value,writer:b.value}),window.location.reload()}catch(U){d.value=F(U)}}const x=await S();return r.value=e.value&&m.value&&v.value===x.id,{user:x,addMovie:q,add_form_is_open:a,allow_movie_adding:r,title_pl:t,title_eng:f,year:w,runtime:y,director:g,writer:b,errors:d}}},s=a=>(j("data-v-cb533a2c"),a=a(),E(),a),W={class:"user-page-container"},Y={key:1,class:"review-form-container"},z=s(()=>o("label",{for:"title_pl-input"},"Title pl",-1)),G=s(()=>o("label",{for:"title_eng-input"},"Title eng",-1)),H=s(()=>o("label",{for:"year-input"},"Year",-1)),J=s(()=>o("label",{for:"runtime-input"},"Runtime",-1)),K=s(()=>o("label",{for:"director-input"},"Director",-1)),O=s(()=>o("label",{for:"writer-input"},"Writer",-1)),Q=s(()=>o("button",{type:"submit"},"Add",-1)),X={key:0,class:"errors"},Z={class:"user-data-container"},$=s(()=>o("p",null,"User reviews:",-1)),ee={class:"reviews-container"};function te(a,r,p,e,v,m){const d=T("ReviewComponent");return n(),l("div",W,[o("div",null,[e.allow_movie_adding?(n(),l("button",{key:0,onClick:r[0]||(r[0]=t=>e.add_form_is_open=!e.add_form_is_open),class:"add-movie-btn"},"Add movie to the database")):c("",!0),e.add_form_is_open?(n(),l("div",Y,[o("form",{onSubmit:r[7]||(r[7]=D((...t)=>e.addMovie&&e.addMovie(...t),["prevent"]))},[z,u(o("input",{type:"text",id:"title_pl-input","onUpdate:modelValue":r[1]||(r[1]=t=>e.title_pl=t),required:""},null,512),[[_,e.title_pl]]),G,u(o("input",{type:"text",id:"title_eng-input","onUpdate:modelValue":r[2]||(r[2]=t=>e.title_eng=t),required:""},null,512),[[_,e.title_eng]]),H,u(o("input",{type:"text",id:"year-input","onUpdate:modelValue":r[3]||(r[3]=t=>e.year=t),required:""},null,512),[[_,e.year]]),J,u(o("input",{type:"text",id:"runtime-input","onUpdate:modelValue":r[4]||(r[4]=t=>e.runtime=t),required:""},null,512),[[_,e.runtime]]),K,u(o("input",{type:"text",id:"director-input","onUpdate:modelValue":r[5]||(r[5]=t=>e.director=t),required:""},null,512),[[_,e.director]]),O,u(o("input",{type:"text",id:"writer-input","onUpdate:modelValue":r[6]||(r[6]=t=>e.writer=t),required:""},null,512),[[_,e.writer]]),Q],32),e.errors.length?(n(),l("div",X,[o("ul",null,[(n(!0),l(V,null,h(e.errors,t=>(n(),l("li",null,k(t),1))),256))])])):c("",!0)])):c("",!0)]),o("div",Z,[o("p",null,k(e.user.username),1),$]),o("div",ee,[(n(!0),l(V,null,h(e.user.user_reviews,t=>(n(),N(d,{key:t.id,review:t},null,8,["review"]))),128))])])}const ne=A(L,[["render",te],["__scopeId","data-v-cb533a2c"]]);export{ne as default};
